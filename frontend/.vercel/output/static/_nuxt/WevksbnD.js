const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DDDR5fuo.js","./entry.CrbF-65G.css"])))=>i.map(i=>d[i]);
import{d as f,I as P,o as B,J as m,K as L,x as w,y as b,z as d,_ as y,B as C}from"./DDDR5fuo.js";const O=globalThis.setInterval,M={class:"map-wrapper"},T=f({__name:"PowerMap",setup(h){const{theme:s}=P();async function c(){const e="https://decentralized-power-tracker.onrender.com";console.log("Fetching all data");const l=await(await fetch(`${e}/power-data/`)).json();return console.log("All data:",l),l.data}return B(async()=>{await m(()=>import("./DDDR5fuo.js").then(a=>a.O),__vite__mapDeps([0,1]),import.meta.url);const e=await m(()=>import("./7ah4FPQk.js").then(a=>a.l),[],import.meta.url),r=[],l=e.latLngBounds([6.5,68],[37.1,97.4]),o=e.map("map",{center:[21.7679,78.8718],zoom:5,zoomControl:!1,attributionControl:!1,maxBounds:l,maxBoundsViscosity:1,minZoom:4.5}),p=e.tileLayer("https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{r}.png",{maxZoom:19,attribution:"&copy; OpenStreetMap & CartoDB"}),_=e.tileLayer("https://{s}.basemaps.cartocdn.com/dark_nolabels/{z}/{x}/{y}{r}.png",{maxZoom:19,attribution:"&copy; OpenStreetMap & CartoDB"});let i=s.value==="dark"?_:p;i.addTo(o),L(s,a=>{const t=a==="dark"?_:p;o.hasLayer(i)&&o.removeLayer(i),t.addTo(o),i=t},{immediate:!1});const g=await(await fetch("/geo/in.geojson")).json(),v=e.geoJSON(g,{style:{color:"var(--color-accent)",weight:2,fillOpacity:.1}}).addTo(o);o.fitBounds(v.getBounds());function k(a){console.log(a);let t="";a.avg_power_availability>.85?t="#00ff00":a.avg_power_availability>.5?t="#ffc800":t="#ff0000";const n=e.circleMarker([a.latitude,a.longitude],{radius:6,color:t,fillColor:t,fillOpacity:.5,stroke:!1}).addTo(o).bindPopup(`

        <b>Currently Powered:</b> ${a.is_power_available}<br/>
        <b>Power Availability:</b> ${(a.avg_power_availability*100).toFixed(2)}%<br/>
        <b>Power Cuts:</b> ${a.avg_power_cuts_count.toFixed(2)} per week<br/>
        <b>Complaints:</b> ${a.complaints_count}<br/>
        <b>Power availability time:</b> ${(a.avg_power_availability*24).toFixed(2)} hr/day
`);return n.on("popupopen",()=>{n.setStyle({radius:10,fillOpacity:.8})}),n.on("popupclose",()=>{n.setStyle({radius:6,fillOpacity:.5})}),n}function x(){r.forEach(a=>o.removeLayer(a)),r.length=0}async function u(){console.log("Refreshing power data...");const a=await c();x();for(const t of a)r.push(k(t.power_data))}await u(),O(async()=>{await u()},6e4)}),(e,r)=>(b(),w("div",M,[...r[0]||(r[0]=[d("div",{id:"map"},null,-1),d("h3",null,"PowerChain",-1)])]))}}),A=Object.assign(y(T,[["__scopeId","data-v-d062de7f"]]),{__name:"PowerMap"}),$="https://decentralized-power-tracker.onrender.com",z=f({__name:"index",setup(h){async function s(){console.log("Fetching all data");const e=await(await fetch(`${$}/power-data/`)).json();console.log("All data:",e)}return(c,e)=>(b(),w("main",null,[C(A,{class:"odd-section"}),d("button",{onClick:s},"Fetch")]))}}),E=y(z,[["__scopeId","data-v-13e9bb44"]]);export{E as default};
